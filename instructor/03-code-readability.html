<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Advanced R: R for Reproducibility: Code readability</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/incubator/favicon-16x16.png"><link rel="manifest" href="../favicons/incubator/site.webmanifest"><link rel="mask-icon" href="../favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../03-code-readability.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Advanced R: R for Reproducibility
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Advanced R: R for Reproducibility
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Advanced R: R for Reproducibility
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 23%" class="percentage">
    23%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 23%" aria-valuenow="23" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../03-code-readability.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Course introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-good-practices.html">2. Good Practices</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Code readability
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#remove-unused-files-and-folders">Remove unused files and folders</a></li>
<li><a href="#use-meaningful-file-names">Use meaningful file names</a></li>
<li><a href="#place-library-statements-at-the-top">Place <code>library</code> statements at the top</a></li>
<li><a href="#use-meaningful-variable-names">Use meaningful variable names</a></li>
<li><a href="#use-standard-libraries">Use standard libraries</a></li>
<li><a href="#use-comments-to-explain-functionality">Use comments to explain functionality</a></li>
<li><a href="#separate-units-of-functionality">Separate units of functionality</a></li>
<li><a href="#function-documentation">Function Documentation</a></li>
<li><a href="#functions-for-modular-and-reusable-code-revisited.">Functions for modular and reusable code revisited.</a></li>
<li><a href="#further-reading">Further reading</a></li>
<li><a href="#attribution">Attribution</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-project-structure.html">4. Code structure</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-code-documentation.html">5. Code documentation</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-code-correctness.html">6. Code correctness</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-code-environment.html">7. Reproducible development environment</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-wrap-up.html">8. Wrap-up</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-good-practices.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-project-structure.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-good-practices.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Good Practices
        </a>
        <a class="chapter-link float-end" href="../instructor/04-project-structure.html" rel="next">
          Next: Code structure...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Code readability</h1>
        <p>Last updated on 2025-03-12 |

        <a href="https://github.com/kkh451/r_reproducibility/edit/main/episodes/03-code-readability.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>Why does code readability matter?</li>
<li>How can I organise my code to be more readable?</li>
<li>What types of documentation can I include to improve the readability
of my code?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<p>After completing this episode, participants should be able to:</p>
<ul><li>Organise R code into reusable functions that achieve a singular
purpose</li>
<li>Choose function and variable names that help explain the purpose of
the function or variable</li>
<li>Write informative comments and to provide more detail about what the
code is doing</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>In this episode, we will introduce the concept of readable code and
consider how it can help create reusable scientific software and empower
collaboration between researchers.</p>
<p>When someone writes code, they do so based on requirements that are
likely to change in the future. Requirements change because code
interacts with the real world, which is dynamic. When these requirements
change, the developer (who is not necessarily the same person who wrote
the original code) must implement the new requirements. They do this by
reading the original code to understand how it currently works and
identify what needs to change. Readable code facilitates this process
and saves future you and developers’ time and effort.</p>
<p>In order to develop readable code, we should ask ourselves: “If I
re-read this piece of code in fifteen days or one year, will I be able
to understand what I have done and why?” Or even better: “If a new
person who just joined the project reads my software, will they be able
to understand what I have written here?”</p>
<p>We will now learn about a few best practices we can follow to help
create more readable code.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>At this point, the code in your local software project’s directory
should be as in:</p>
<p>TODO</p>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="remove-unused-files-and-folders">Remove unused files and folders<a class="anchor" aria-label="anchor" href="#remove-unused-files-and-folders"></a></h2>
<hr class="half-width"><p>Let’s start by removing any files or folders that are not needed in
our project directory.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> astronaut-data-analyses-old</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="use-meaningful-file-names">Use meaningful file names<a class="anchor" aria-label="anchor" href="#use-meaningful-file-names"></a></h2>
<hr class="half-width"><p>Let’s give our analysis script a meaningful name that reflects what
it does and do the same for our input and output files.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">mv</span> my_analysis_v2.R eva_data_analysis.R </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">mv</span> data.json eva_data.json</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="place-library-statements-at-the-top">Place <code>library</code> statements at the top<a class="anchor" aria-label="anchor" href="#place-library-statements-at-the-top"></a></h2>
<hr class="half-width"><p>Let’s have a look at our code again - the first thing we may notice
is that our script currently places <code>library()</code> statements
throughout the code. Conventionally, all <code>library()</code>
statements are placed at the top of the script so that dependent
libraries are clearly visible and not buried inside the code This will
help readability (accessibility) and reusability of our code.</p>
<p>Our code after the modification should look like the following.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># https://data.nasa.gov/resource/eva.json (with modifications)</span></span>
<span><span class="co"># File paths</span></span>
<span><span class="va">data_f</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">data_t</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">g_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="va">fieldnames</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"eva"</span>, <span class="st">"country"</span>, <span class="st">"crew"</span>, <span class="st">"vehicle"</span>, <span class="st">"date"</span>, <span class="st">"duration"</span>, <span class="st">"purpose"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu">readLines</span><span class="op">(</span><span class="va">data_f</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 374</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">374</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">line</span> <span class="op">&lt;-</span> <span class="va">data_raw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">line</span><span class="op">)</span></span>
<span>  <span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="fu">substr</span><span class="op">(</span><span class="va">line</span>, <span class="fl">2</span>, <span class="fu">nchar</span><span class="op">(</span><span class="va">line</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Initialize empty vectors</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">data</span><span class="op">)</span> <span class="op">{</span>  <span class="co"># Iterate manually</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="st">"duration"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tt</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">duration</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">tt</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Do nothing if empty</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">t_parts</span> <span class="op">&lt;-</span> <span class="fu">strsplit</span><span class="op">(</span><span class="va">tt</span>, <span class="st">":"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">ttt</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">t_parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">t_parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span>  <span class="co"># Convert to hours</span></span>
<span>      <span class="fu">print</span><span class="op">(</span><span class="va">ttt</span><span class="op">)</span></span>
<span>      <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">time</span>, <span class="va">ttt</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="st">"date"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="st">"eva"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">substr</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span>
<span>        <span class="va">year</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="fu">format</span><span class="op">(</span><span class="va">date</span>,<span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">dates</span>, <span class="va">date</span><span class="op">)</span></span>
<span>        <span class="va">years</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">years</span>, <span class="va">year</span><span class="op">)</span></span>
<span>        <span class="va">row_data</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co">## Comment out this bit if you don't want the spreadsheet</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">exists</span><span class="op">(</span><span class="st">"row_data"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">print</span><span class="op">(</span><span class="va">row_data</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">w</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">write.table</span><span class="op">(</span><span class="va">row_data</span>, <span class="va">data_t</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu">write.table</span><span class="op">(</span><span class="va">row_data</span>, <span class="va">data_t</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="va">w</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="fu">rm</span><span class="op">(</span><span class="va">row_data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">exists</span><span class="op">(</span><span class="st">"ct"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">time</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">ct</span>, <span class="va">ct</span><span class="op">[</span><span class="fu">length</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu">order</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">years</span><span class="op">[</span><span class="va">sorted_indices</span><span class="op">]</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="va">sorted_indices</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Print total time in space</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">ct</span><span class="op">[</span><span class="fu">length</span><span class="op">(</span><span class="va">ct</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tdf</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  ct <span class="op">=</span> <span class="va">ct</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the data</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">tdf</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">years</span>, y <span class="op">=</span> <span class="va">ct</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span> x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>, title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span> <span class="op">)</span> <span class="op">+</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correction for repeatability</span></span>
<span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save plot</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">g_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="use-meaningful-variable-names">Use meaningful variable names<a class="anchor" aria-label="anchor" href="#use-meaningful-variable-names"></a></h2>
<hr class="half-width"><p>Variables are the most common thing you will assign when coding, and
it’s really important that it is clear what each variable means in order
to understand what the code is doing. If you return to your code after a
long time doing something else, or share your code with a colleague, it
should be easy enough to understand what variables are involved in your
code from their names. Therefore we need to give them clear names, but
we also want to keep them concise so the code stays readable. There are
no “hard and fast rules” here, and it’s often a case of using your best
judgment.</p>
<p>Some useful tips for naming variables are:</p>
<ul><li>Short words are better than single character names. For example, if
we were creating a variable to store the speed to read a file,
<code>s</code> (for ‘speed’) is not descriptive enough but
<code>MBReadPerSecondAverageAfterLastFlushToLog</code> is too long to
read and prone to misspellings. <code>ReadSpeed</code> (or
<code>read_speed</code>) would suffice.</li>
<li>If you are finding it difficult to come up with a variable name that
is both short and descriptive, go with the short version and use an
inline comment to describe it further (more on those in the next
section). This guidance does not necessarily apply if your variable is a
well-known constant in your domain - for example, <em>c</em> represents
the speed of light in physics.</li>
<li>Try to be descriptive where possible and avoid meaningless or funny
names like <code>foo</code>, <code>bar</code>, <code>var</code>,
<code>thing</code>, etc.</li>
</ul><p>Remember there are some restrictions to consider when naming
variables in R - variable names can only contain letters, numbers,
underscores and full-stops. They cannot start with a number or contain
spaces.</p>
<div id="give-a-descriptive-name-to-a-variable" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="give-a-descriptive-name-to-a-variable" class="callout-inner">
<h3 class="callout-title">Give a descriptive name to a variable</h3>
<div class="callout-content">
<p>Below we have a variable called <code>var</code> being set the value
of 9.81. <code>var</code> is not a very descriptive name here as it
doesn’t tell us what 9.81 means, yet it is a very common constant in
physics! Go online and find out which constant 9.81 relates to and
suggest a new name for this variable.</p>
<p>Hint: the units are <em>metres per second squared</em>!</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fl">9.81</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><span class="math display">\[ 9.81 m/s^2 \]</span> is the <a href="https://en.wikipedia.org/wiki/Gravity_of_Earth" class="external-link">gravitational
force exerted by the Earth</a>. It is often referred to as “little g” to
distinguish it from “big G” which is the <a href="https://en.wikipedia.org/wiki/Gravitational_constant" class="external-link">Gravitational
Constant</a>. A more descriptive name for this variable therefore might
be:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_earth</span> <span class="op">&lt;-</span> <span class="fl">9.81</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="rename-our-variables-to-be-more-descriptive" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="rename-our-variables-to-be-more-descriptive" class="callout-inner">
<h3 class="callout-title">Rename our variables to be more descriptive</h3>
<div class="callout-content">
<p>Let’s apply this to <code>eva_data_analysis.R</code>.</p>
<ol style="list-style-type: lower-alpha"><li>
<p>Edit the code as follows to use descriptive variable names:</p>
<ul><li>Change data_f to input_file</li>
<li>Change data_t to output_file</li>
<li>Change g_file to graph_file</li>
</ul></li>
<li><p>What other variable names in our code would benefit from
renaming?</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: lower-alpha"><li>Updated code:</li>
</ol><div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># https://data.nasa.gov/resource/eva.json (with modifications)</span></span>
<span><span class="co"># File paths</span></span>
<span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">graph_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="va">fieldnames</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"eva"</span>, <span class="st">"country"</span>, <span class="st">"crew"</span>, <span class="st">"vehicle"</span>, <span class="st">"date"</span>, <span class="st">"duration"</span>, <span class="st">"purpose"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu">readLines</span><span class="op">(</span><span class="va">input_file</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 374</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">374</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">line</span> <span class="op">&lt;-</span> <span class="va">data_raw</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">line</span><span class="op">)</span></span>
<span>  <span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="fu">substr</span><span class="op">(</span><span class="va">line</span>, <span class="fl">2</span>, <span class="fu">nchar</span><span class="op">(</span><span class="va">line</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Initialize empty vectors</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">rownno</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">data</span><span class="op">)</span> <span class="op">{</span>  <span class="co"># Iterate manually</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="st">"duration"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">time_text</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">duration</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">time_text</span> <span class="op">==</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Do nothing if empty</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">t_parts</span> <span class="op">&lt;-</span> <span class="fu">strsplit</span><span class="op">(</span><span class="va">time_text</span>, <span class="st">":"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">t_hours</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">t_parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">t_parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span>  <span class="co"># Convert to hours</span></span>
<span>      <span class="fu">print</span><span class="op">(</span><span class="va">t_hours</span><span class="op">)</span></span>
<span>      <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">time</span>, <span class="va">t_hours</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="st">"date"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="st">"eva"</span> <span class="op">%in%</span> <span class="fu">names</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">as.Date</span><span class="op">(</span><span class="fu">substr</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>, <span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span><span class="op">)</span></span>
<span>        <span class="va">year</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="fu">format</span><span class="op">(</span><span class="va">date</span>,<span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">dates</span>, <span class="va">date</span><span class="op">)</span></span>
<span>        <span class="va">years</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">years</span>, <span class="va">year</span><span class="op">)</span></span>
<span>        <span class="va">row_data</span> <span class="op">&lt;-</span> <span class="fu">as.data.frame</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co">## Comment out this bit if you don't want the spreadsheet</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">exists</span><span class="op">(</span><span class="st">"row_data"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">print</span><span class="op">(</span><span class="va">row_data</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">rownno</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">write.table</span><span class="op">(</span><span class="va">row_data</span>, <span class="va">output_file</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">TRUE</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu">write.table</span><span class="op">(</span><span class="va">row_data</span>, <span class="va">output_file</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="cn">FALSE</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">rownno</span> <span class="op">&lt;-</span> <span class="va">rowno</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="fu">rm</span><span class="op">(</span><span class="va">row_data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">exists</span><span class="op">(</span><span class="st">"cumulative_time"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="va">cumulative_time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">time</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cumulative_time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">cumulative_time</span>, <span class="va">cumulative_time</span><span class="op">[</span><span class="fu">length</span><span class="op">(</span><span class="va">cumulative_time</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sorted_indices</span> <span class="op">&lt;-</span> <span class="fu">order</span><span class="op">(</span><span class="va">dates</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">years</span><span class="op">[</span><span class="va">sorted_indices</span><span class="op">]</span></span>
<span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="va">sorted_indices</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Print total time in space</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">cumulative_time</span><span class="op">[</span><span class="fu">length</span><span class="op">(</span><span class="va">cumulative_time</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tdf</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  cumulative_time <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the data</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">tdf</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">years</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span> x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>, title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span> <span class="op">)</span> <span class="op">+</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correction for repeatability</span></span>
<span><span class="va">cumulative_time</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save plot</span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: lower-alpha"><li>We should also rename variables <code>w</code>, <code>tt</code>,
<code>ttt</code>, <code>ct</code> to be more descriptive. In the
solution above, these have been renamed to rownno, time_text, t_hours
and cumulative_time respectively.</li>
</ol></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="use-standard-libraries">Use standard libraries<a class="anchor" aria-label="anchor" href="#use-standard-libraries"></a></h2>
<hr class="half-width"><p>Our script currently reads the data line-by-line from the JSON data
file and uses custom code to manipulate the data. Variables of interest
are stored in lists but there are more suitable data structures
(e.g. data frames) to store data in our case. By choosing custom code
over standard and well-tested libraries, we are making our code less
readable and understandable and more error-prone.</p>
<p>The main functionality of our code can be rewritten as follows using
the <code>dplyr</code> library to load and manipulate the data in data
frames.</p>
<p>The code should now look like:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">graph_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="va">eva_data</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="va">input_file</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>eva <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">eva</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">arrange</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">eva_data</span>, <span class="va">output_file</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">eva_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span></span>
<span>                  <span class="fu">sum</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">str_split_1</span><span class="op">(</span><span class="va">duration</span>, <span class="st">"\\:"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span></code></pre>
</div>
<p>We should replace the existing code in our R script
<code>eva_data_analysis.R</code> with the above code.</p>
</section><section><h2 class="section-heading" id="use-comments-to-explain-functionality">Use comments to explain functionality<a class="anchor" aria-label="anchor" href="#use-comments-to-explain-functionality"></a></h2>
<hr class="half-width"><p>Commenting is a very useful practice to help convey the context of
the code. It can be helpful as a reminder for your future self or your
collaborators as to why code is written in a certain way, how it is
achieving a specific task, or the real-world implications of your
code.</p>
<p>There are several ways to add comments to code:</p>
<ul><li>An <strong>inline comment</strong> is a comment on the same line as
a code statement. Typically, it comes after the code statement and
finishes when the line ends and is useful when you want to explain the
code line in short. Inline comments in R should be separated by at least
two spaces from the statement; they start with a # followed by a single
space, and have no end delimiter.</li>
</ul><div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">5</span>  <span class="co"># In R, inline comments begin with the `#` symbol and a single space.</span></span></code></pre>
</div>
<ul><li>A <strong>multi-line</strong> or <strong>block comment</strong>
spans multiple lines. R doesn’t have a specific multiline comment
syntax, a common practice is to use a single # for each line but make it
look like a block comment for readability. You could also align the #
symbol vertically to create a visually consistent block of
comments.</li>
</ul><div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ==========================================</span></span>
<span><span class="co"># This is a block comment.</span></span>
<span><span class="co"># You can write a detailed explanation here.</span></span>
<span><span class="co"># It can span multiple lines as needed.</span></span>
<span><span class="co"># ==========================================</span></span></code></pre>
</div>
<p>Here are a few things to keep in mind when commenting your code:</p>
<ul><li>Focus on the <strong>why</strong> and the <strong>how</strong> of
your code - avoid using comments to explain <strong>what</strong> your
code does. If your code is too complex for other programmers to
understand, consider rewriting it for clarity rather than adding
comments to explain it.</li>
<li>Make sure you are not reiterating something that your code already
conveys on its own. Comments should not echo your code.</li>
<li>Keep comments short and concise. Large blocks of text quickly become
unreadable and difficult to maintain.</li>
<li>Comments that contradict the code are worse than no comments. Always
make a priority of keeping comments up-to-date when code changes.</li>
</ul><div class="section level3">
<h3 id="examples-of-unhelpful-comments">Examples of unhelpful comments<a class="anchor" aria-label="anchor" href="#examples-of-unhelpful-comments"></a></h3>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statetax</span> <span class="op">&lt;-</span> <span class="fl">1.0625</span>  <span class="co"># Assigns the float 1.0625 to the variable 'statetax'</span></span>
<span><span class="va">citytax</span> <span class="op">&lt;-</span> <span class="fl">1.01</span>  <span class="co"># Assigns the float 1.01 to the variable 'citytax'</span></span>
<span><span class="va">specialtax</span> <span class="op">&lt;-</span> <span class="fl">1.01</span>  <span class="co"># Assigns the float 1.01 to the variable 'specialtax'</span></span></code></pre>
</div>
<p>The comments in this code simply tell us what the code does, which is
easy enough to figure out without the inline comments.</p>
</div>
<div class="section level3">
<h3 id="examples-of-helpful-comments">Examples of helpful comments<a class="anchor" aria-label="anchor" href="#examples-of-helpful-comments"></a></h3>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statetax</span> <span class="op">=</span> <span class="fl">1.0625</span>  <span class="co"># State sales tax rate is 6.25% through Jan. 1</span></span>
<span><span class="va">citytax</span> <span class="op">=</span> <span class="fl">1.01</span>  <span class="co"># City sales tax rate is 1% through Jan. 1</span></span>
<span><span class="va">specialtax</span> <span class="op">=</span> <span class="fl">1.01</span>  <span class="co"># Special sales tax rate is 1% through Jan. 1</span></span></code></pre>
</div>
<p>In this case, it might not be immediately obvious what each variable
represents, so the comments offer helpful, real-world context. The date
in the comment also indicates when the code might need to be
updated.</p>
<div id="add-comments-to-our-code" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="add-comments-to-our-code" class="callout-inner">
<h3 class="callout-title">Add comments to our code</h3>
<div class="callout-content">
<ol style="list-style-type: lower-alpha"><li><p>Examine <code>eva_data_analysis.R</code>. Add as many comments as
you think is required to help yourself and others understand what that
code is doing.</p></li>
<li><p>Add as many print statements as you think is required to keep the
user informed about what the code is doing as it runs.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Some good comments and print statements may look like the example
below.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ibrary</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># https://data.nasa.gov/resource/eva.json (with modifications)</span></span>
<span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">graph_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--START--"</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Reading JSON file"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the data from a JSON file into a dataframe</span></span>
<span><span class="va">eva_data</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="va">input_file</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>eva <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">eva</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span> <span class="fu">arrange</span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Saving to CSV file"</span><span class="op">)</span></span>
<span><span class="co"># Save dataframe to CSV file for later analysis</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">eva_data</span>, <span class="va">output_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Plotting cumulative spacewalk duration and saving to file"</span><span class="op">)</span></span>
<span><span class="co"># Plot cumulative time spent in space over years</span></span>
<span><span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">eva_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span></span>
<span>                  <span class="fu">sum</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">str_split_1</span><span class="op">(</span><span class="va">duration</span>, <span class="st">"\\:"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Calculate cumulative time</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--END--"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="separate-units-of-functionality">Separate units of functionality<a class="anchor" aria-label="anchor" href="#separate-units-of-functionality"></a></h2>
<hr class="half-width"><p>Functions are a fundamental concept in writing software and are one
of the core ways you can organise your code to improve its readability.
A function is an isolated section of code that performs a single,
<em>specific</em> task that can be simple or complex. It can then be
called multiple times with different inputs throughout a codebase, but
its definition only needs to appear once.</p>
<p>Breaking up code into functions in this manner benefits readability
since the smaller sections are easier to read and understand. Since
functions can be reused, codebases naturally begin to follow the <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" class="external-link">Don’t
Repeat Yourself principle</a> which prevents software from becoming
overly long and confusing. The software also becomes easier to maintain
because, if the code encapsulated in a function needs to change, it only
needs updating in one place instead of many. As we will learn in a
future episode, testing code also becomes simpler when code is written
in functions. Each function can be individually checked to ensure it is
doing what is intended, which improves confidence in the software as a
whole.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Decomposing code into functions helps with reusability of blocks of
code and eliminating repetition, but, equally importantly, it helps with
code readability and testing.</p>
</div>
</div>
</div>
<p>Looking at our code, you may notice it contains different pieces of
functionality:</p>
<ol style="list-style-type: decimal"><li>reading the data from a JSON file</li>
<li>converting and saving the data in the CSV format</li>
<li>processing/cleaning the data and preparing it for analysis</li>
<li>data analysis and visualising the results</li>
</ol><p>Let’s refactor our code so that reading the data in JSON format into
a dataframe (step 1.) and converting it and saving to the CSV format
(step 2.) is extracted into a separate function. Let’s name this
function <code>read_json_to_dataframe</code>. The main part of the
script should then be simplified to invoke these new functions, while
the function itself contain the complexity of this step. We will
continue to work on steps 3. and 4. above later on.</p>
<p>After the initial refactoring, our code may look something like the
following.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">read_json_to_dataframe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Reading JSON file"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">eva_df</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="va">input_file</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>eva <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">eva</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">eva_df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># https://data.nasa.gov/resource/eva.json (with modifications)</span></span>
<span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">graph_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--START--"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Read the data from a JSON file into a dataframe</span></span>
<span><span class="va">eva_data</span> <span class="op">&lt;-</span> <span class="fu">read_json_to_dataframe</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save dataframe to CSV file for later analysis</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">eva_data</span>, <span class="va">output_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Plotting cumulative spacewalk duration and saving to file"</span><span class="op">)</span></span>
<span><span class="co"># Plot cumulative time spent in space over years</span></span>
<span><span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">eva_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span></span>
<span>                  <span class="fu">sum</span><span class="op">(</span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">str_split_1</span><span class="op">(</span><span class="va">duration</span>, <span class="st">"\\:"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Calculate cumulative time</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--END--"</span><span class="op">)</span></span></code></pre>
</div>
<p>We have chosen to create functions for reading in our data files
since this is a very common task within research software. While this
function does not contain that many lines of code due to using the
<code>tidyverse</code> functions that do all the complex data reading
and data preparation operations, it can be useful to package these steps
together into reusable functions if you need to read in or write out a
lot of similarly structured files and process them in the same way.</p>
</section><section><h2 class="section-heading" id="function-documentation">Function Documentation<a class="anchor" aria-label="anchor" href="#function-documentation"></a></h2>
<hr class="half-width"><p>Now that we have written some functions, it is time to document them
so that we can quickly recall (and others looking at our code in the
future can understand) what the functions do without having to read the
code.</p>
<p><em>Roxygen comments</em> are a specific type of function-level
documentation that are provided within R functions and classes. Function
level documentation should explain what that particular code is doing,
what parameters the function needs (inputs) and what form they should
take, what the function outputs (you may see words like ‘return’ here),
and errors (if any) that might be raised.</p>
<p>Providing Roxygen comments helps improve code readability since it
makes the function code more transparent and aids understanding.
Particularly, roxygen comments that provide information on the input and
output of functions makes it easier to reuse them in other parts of the
code, without having to read the full function to understand what needs
to be provided and what will be returned.</p>
<p>Roxygen comment lines in R start with #’ to indicate that they are
documentation and are written directly above the function definition.
The tag <span class="citation">@param</span> is used to document
function parameters, while <span class="citation">@return</span>
describes what the function returns, and you can also use <span class="citation">@details</span> to give additional information such as
errors.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Divide number x by number y.</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @param x A number to be divided.</span></span>
<span><span class="co">#' @param y A number to divide by.</span></span>
<span><span class="co">#' @return The result of dividing x by y.</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @details</span></span>
<span><span class="co">#' If y is zero, this will result in an error (division by zero).</span></span>
<span><span class="va">divide</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">return</span><span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>We’ll see later in the course how the <code>roxygen2</code> package
can be used to automatically generate formal documentation for the
function. while the package <code>pkgdown</code> can be used to generate
a documentation website for our whole project.</p>
<p>Let’s write a roxygen comment for the function
<code>read_json_to_dataframe</code> we introduced in the previous
exercise. Remember, questions we want to answer when writing the
function-level documentation include:</p>
<ul><li>What the function does?</li>
<li>What kind of inputs does the function take? Are they required or
optional? Do they have default values?</li>
<li>What output will the function produce?</li>
<li>What exceptions/errors, if any, it can produce?</li>
</ul><p>Our <code>read_json_to_dataframe</code> function fully described by a
roxygen comment block may look like:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Read and Clean EVA Data from JSON</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function reads EVA data from a JSON file, cleans it by converting</span></span>
<span><span class="co">#' the 'eva' column to numeric, converting data from text to date format,</span></span>
<span><span class="co">#. creating a year variable and removing rows with missing values, and sorts</span></span>
<span><span class="co">#' the data by the 'date' column.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param input_file A character string specifying the path to the input JSON file.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A cleaned and sorted data frame containing the EVA data.</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">read_json_to_dataframe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Reading JSON file"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">eva_df</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="va">input_file</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>eva <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">eva</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">eva_df</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div id="writing-roxygen-comments" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="writing-roxygen-comments" class="callout-inner">
<h3 class="callout-title">Writing roxygen comments</h3>
<div class="callout-content">
<p>Write a roxygen comment for this function
<code>text_to_duration</code>:.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">text_to_duration</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time_parts</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_split</span><span class="op">(</span><span class="va">duration</span>, <span class="st">":"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">minutes</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">duration_hours</span> <span class="op">&lt;-</span> <span class="va">hours</span> <span class="op">+</span> <span class="va">minutes</span> <span class="op">/</span> <span class="fl">60</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>Our <code>text_to_duration</code> function fully described by roxygen
comments may look like:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Convert Duration from HH:MM Format to Hours</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts a duration in "HH:MM" format (as a character string)</span></span>
<span><span class="co">#' into the total duration in hours (as a numeric value).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @details</span></span>
<span><span class="co">#' When applied to a vector, it will only process and return the first element</span></span>
<span><span class="co">#' so this function must be applied to a data frame rowwise.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param duration A character string representing the duration in "HH:MM" format.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A numeric value representing the duration in hours.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' text_to_duration("03:45")  # Returns 3.75 hours</span></span>
<span><span class="co">#' text_to_duration("12:30")  # Returns 12.5 hours</span></span>
<span><span class="va">text_to_duration</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time_parts</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_split</span><span class="op">(</span><span class="va">duration</span>, <span class="st">":"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">minutes</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">duration_hours</span> <span class="op">&lt;-</span> <span class="va">hours</span> <span class="op">+</span> <span class="va">minutes</span> <span class="op">/</span> <span class="fl">60</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="functions-for-modular-and-reusable-code-revisited-">Functions for modular and reusable code revisited.<a class="anchor" aria-label="anchor" href="#functions-for-modular-and-reusable-code-revisited-"></a></h2>
<hr class="half-width"><p>As we have already seen earlier in this episode - functions play a
key role in creating modular and reusable code. We are going to carry on
improving our code following these principles:</p>
<ul><li>Each function should have a single, clear responsibility. This makes
functions easier to understand, test, and reuse.</li>
<li>Write functions that can be easily combined or reused with other
functions to build more complex functionality.</li>
<li>Functions should accept parameters to allow flexibility and
reusability in different contexts; avoid hard-coding values inside
functions/code (e.g. data files to read from/write to) and pass them as
arguments instead.</li>
</ul><p>Bearing in mind the above principles, we can further simplify the
main part of our code by extracting the code to process, analyse our
data and plot a graph into a separate function
<code>plot_cumulative_time_in_space</code>.</p>
<p>We can further extract the code to convert the spacewalk duration
text into a number to allow for arithmetic calculations (into a separate
function <code>text_to_duration</code>).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">readr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">stringr</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' Read and Clean EVA Data from JSON</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function reads EVA data from a JSON file, cleans it by converting</span></span>
<span><span class="co">#' the 'eva' column to numeric, converting data from text to date format,</span></span>
<span><span class="co">#. creating a year variable and removing rows with missing values, and sorts</span></span>
<span><span class="co">#' the data by the 'date' column.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param input_file A character string specifying the path to the input JSON file.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A cleaned and sorted data frame containing the EVA data.</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">read_json_to_dataframe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="st">"Reading JSON file"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">eva_df</span> <span class="op">&lt;-</span> <span class="fu">fromJSON</span><span class="op">(</span><span class="va">input_file</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>eva <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">eva</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">eva_df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Convert Duration from HH:MM Format to Hours</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function converts a duration in "HH:MM" format (as a character string)</span></span>
<span><span class="co">#' into the total duration in hours (as a numeric value).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @details</span></span>
<span><span class="co">#' When applied to a vector, it will only process and return the first element</span></span>
<span><span class="co">#' so this function must be applied to a data frame rowwise.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param duration A character string representing the duration in "HH:MM" format.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A numeric value representing the duration in hours.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' text_to_duration("03:45")  # Returns 3.75 hours</span></span>
<span><span class="co">#' text_to_duration("12:30")  # Returns 12.5 hours</span></span>
<span><span class="va">text_to_duration</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time_parts</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu">str_split</span><span class="op">(</span><span class="va">duration</span>, <span class="st">":"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">minutes</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">time_parts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">duration_hours</span> <span class="op">&lt;-</span> <span class="va">hours</span> <span class="op">+</span> <span class="va">minutes</span> <span class="op">/</span> <span class="fl">60</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Plot Cumulative Time in Space Over the Years</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function plots the cumulative time spent in space over the years based on</span></span>
<span><span class="co">#' the data in the dataframe. The cumulative time is calculated by converting the</span></span>
<span><span class="co">#' "duration" column into hours, then computing the cumulative sum of the duration.</span></span>
<span><span class="co">#' The plot is saved as a PNG file at the specified location.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param tdf A dataframe containing a "duration" column in "HH:MM" format and a "date" column.</span></span>
<span><span class="co">#' @param graph_file A character string specifying the path to save the graph.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return NULL</span></span>
<span><span class="va">plot_cumulative_time_in_space</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tdf</span>, <span class="va">graph_file</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">tdf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span> <span class="fu">text_to_duration</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># Add duration_hours column</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>     <span class="co"># Calculate cumulative time</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>The main part of our code then becomes much simpler and more
readable, only containing the invocation of the following three
functions:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># https://data.nasa.gov/resource/eva.json (with modifications)</span></span>
<span><span class="va">input_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.json"</span></span>
<span><span class="va">output_file</span> <span class="op">&lt;-</span> <span class="st">"eva-data.csv"</span></span>
<span><span class="va">graph_file</span> <span class="op">&lt;-</span> <span class="st">"cumulative_eva_graph.png"</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--START--"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the data from a JSON file into a dataframe</span></span>
<span><span class="va">eva_data</span> <span class="op">&lt;-</span> <span class="fu">read_json_to_dataframe</span><span class="op">(</span><span class="va">input_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Writing CSV File"</span><span class="op">)</span></span>
<span><span class="co"># Save dataframe to CSV file for later analysis</span></span>
<span><span class="fu">write_csv</span><span class="op">(</span><span class="va">eva_data</span>, <span class="va">output_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"Plotting cumulative spacewalk duration and saving to file"</span><span class="op">)</span></span>
<span><span class="co"># Plot cumulative time spent in space over years</span></span>
<span><span class="fu">plot_cumulative_time_in_space</span><span class="op">(</span><span class="va">eva_data</span>, <span class="va">graph_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="st">"--END--"</span><span class="op">)</span></span>
<span><span class="va">...</span></span></code></pre>
</div>
<div id="using-the-styler-package-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="using-the-styler-package-1" class="callout-inner">
<h3 class="callout-title">Using the styler package <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: lower-alpha"><li>Look up the stylr package. How can it help you make your code more
readable?</li>
<li>Install <code>stylr</code> and apply it to this poorly formatted
version of the <code>plot_cumulative_time_in_space</code> functions we
created.</li>
</ol><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_cumulative_time_in_space</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tdf</span>, <span class="va">graph_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">tdf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>       <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span> <span class="fu">text_to_duration</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add duration_hours column</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Calculate cumulative time</span></span>
<span>       <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>      </span>
<span>      title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<ol style="list-style-type: lower-alpha"><li><p>See <a href="https://r4ds.hadley.nz/workflow-style.html" class="external-link">R for
Data Science</a> for a discussion of <code>stylr</code> and how it can
help you make your code more readable.</p></li>
<li><p><code>plot_cumulative_time_in_space</code> after applying
<code>stylr</code></p></li>
</ol><div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_cumulative_time_in_space</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tdf</span>, <span class="va">graph_file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">time_in_space_plot</span> <span class="op">&lt;-</span> <span class="va">tdf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>duration_hours <span class="op">=</span> <span class="fu">text_to_duration</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add duration_hours column</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>cumulative_time <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">duration_hours</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Calculate cumulative time</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cumulative_time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Total time spent in space to date (hours)"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Cumulative Spacewalk Time"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">ggsave</span><span class="op">(</span><span class="va">graph_file</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="va">time_in_space_plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a></h2>
<hr class="half-width"><p>We recommend the following resources for some additional reading on
the topic of this episode:</p>
<ul><li><a href="https://www.index.dev/blog/7-tell-tale-signs-of-unreadable-code-how-to-identify-and-fix-the-problem" class="external-link">7
tell-tale signs of unreadable code</a></li>
<li><a href="https://www.theguardian.com/info/2019/jan/29/code-readability-matters" class="external-link">‘Code
Readability Matters’ from the Guardian’s engineering blog</a></li>
</ul><p>Also check the <a href="reference.html#litref">full reference set</a>
for the course.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Readable code is easier to understand, maintain, debug and extend
(reuse) - saving time and effort.</li>
<li>Choosing descriptive variable and function names will communicate
their purpose more effectively.</li>
<li>Using comments and function-level documentation (roxygen) to
describe parts of the code will help transmit understanding and
context.</li>
<li>Use libraries or packages for common functionality to avoid
duplication.</li>
<li>Creating functions from the smallest, reusable units of code will
make the code more readable and help. compartmentalise which parts of
the code are doing what actions and isolate specific code sections for
re-use.</li>
</ul></div>
</div>
</div>
</section><section><h2 class="section-heading" id="attribution">Attribution<a class="anchor" aria-label="anchor" href="#attribution"></a></h2>
<hr class="half-width"><p>This episode reuses material from the <a href="https://carpentries-incubator.github.io/fair-research-software/06-code-readability.html" class="external-link">“Code
Readability”</a> episode of the Software Carpentries Incubator course <a href="https://carpentries-incubator.github.io/fair-research-software/" class="external-link">“Tools
and practices of FAIR research software”</a> under a <a href="https://creativecommons.org/licenses/by/4.0/deed.en" class="external-link">CC-BY-4.0</a>
licence with modifications: (i) adaptations have been made to make the
material suitable for an audience of R users (e.g. replacing “software”
with “code” in places, docstrings with roxygen2), (ii) all code has been
ported from Python to R (iii) the example code has been deliberately
modified to be non-repeatable for teaching purposes. (iv) Objectives,
Questions, Key Points and Further Reading sections have been updated to
reflect the remixed R focussed content. Some original material has been
added – this is marked with a footnote.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
<!--
Fair research software
 -->
<!--
Good Practices
 -->
<!---
Project Structure
--->
<!-------
Code Correctness
---->
<!--
Attribution
-->
</section><div class="footnotes footnotes-end-of-document">
<hr><ol><li id="fn1"><p>Original Material<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol></div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-good-practices.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-project-structure.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-good-practices.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Good Practices
        </a>
        <a class="chapter-link float-end" href="../instructor/04-project-structure.html" rel="next">
          Next: Code structure...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/kkh451/r_reproducibility/edit/main/episodes/03-code-readability.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/kkh451/r_reproducibility/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/kkh451/r_reproducibility/" class="external-link">Source</a></p>
				<p><a href="https://github.com/kkh451/r_reproducibility/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:k.r.kopec-harding@bham.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://kkh451.github.io/r_reproducibility/instructor/03-code-readability.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "R, RStudio, lesson, reproducibility",
  "name": "Code readability",
  "creativeWorkStatus": "active",
  "url": "https://kkh451.github.io/r_reproducibility/instructor/03-code-readability.html",
  "identifier": "https://kkh451.github.io/r_reproducibility/instructor/03-code-readability.html",
  "dateCreated": "2024-09-01",
  "dateModified": "2025-03-12",
  "datePublished": "2025-03-12"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

